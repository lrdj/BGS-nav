<script>
  document.addEventListener("DOMContentLoaded", () => {
    const widget = document.querySelector(".select-link-widget");
    const legend = widget.querySelector(".slw-legend");
    const arrow = legend.querySelector(".slw-arrow");

    // Toggle dropdown on click
    legend.addEventListener("click", () => {
      const expanded = widget.classList.contains("expanded");
      widget.classList.toggle("expanded", !expanded);
      legend.setAttribute("aria-expanded", !expanded);
      arrow.setAttribute("aria-expanded", !expanded);
    });

    // Close dropdown on outside click or Escape key
    document.addEventListener("click", (event) => {
      if (!widget.contains(event.target)) {
        widget.classList.remove("expanded");
        legend.setAttribute("aria-expanded", "false");
        arrow.setAttribute("aria-expanded", "false");
      }
    });

    document.addEventListener("keydown", (event) => {
      if (event.key === "Escape") {
        widget.classList.remove("expanded");
        legend.setAttribute("aria-expanded", "false");
        arrow.setAttribute("aria-expanded", "false");
      }
    });
  });
</script>
